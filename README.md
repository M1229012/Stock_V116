# 📈 台股注意股與處置股預測系統 (V116.18)

這是一個基於 Python 的自動化分析系統，專為台股交易者設計。它能自動爬取每日證交所/櫃買中心的公告，結合 FinMind 與 Yahoo Finance 的數據，精準計算並預測股票是否即將進入「處置」（關廁所），幫助使用者規避流動性風險或尋找交易機會。

## ✨ 主要功能

* **處置天數預測**：獨家演算法，精準計算還有幾天會被列為處置股（領先指標）。
* **風險歸零機制**：具備「處置後歸零 (Jail Reset)」邏輯，避免出獄後誤判。
* **多維度風險監控**：涵蓋漲跌幅異常、週轉率過高、當沖佔比過高、本益比異常等多項指標。
* **自動化報表**：執行後自動更新 Google Sheets，產出「近30日熱門統計」與「每日紀錄」。
* **支援上市/上櫃**：完整支援 TWSE (上市) 與 TPEx (上櫃) 股票。

## 📂 專案架構 (模組化設計)

本專案採用模組化設計，將功能拆分為不同的 Python 檔案，方便維護與擴充。

| 檔案名稱 | 角色 | 功能說明 |
| :--- | :--- | :--- |
| **`config.py`** | 設定檔 | 存放常數（如表頭設定）、API 網址、以及**關鍵字對照表 (Keyword Map)**。 |
| **`utils.py`** | 工具箱 | 提供通用的字串處理、日期格式轉換、Google Sheets 連線輔助函式。 |
| **`data.py`** | 資料層 | 負責對外抓取資料（爬蟲、FinMind API、Yahoo Finance），不涉及運算邏輯。 |
| **`logic.py`** | 核心邏輯 | **系統大腦**。包含處置股預測演算法、風險計算、歸零判斷等核心商業邏輯。 |
| **`Main.ipynb`** | 執行檔 | Google Colab 主程式，負責安裝環境、呼叫各模組並執行流程。 |

## 🚀 如何使用 (Google Colab)

### 1. 環境準備
1.  在 Google Drive 根目錄建立一個資料夾，命名為 `Stock_V116`。
2.  將 `config.py`, `utils.py`, `data.py`, `logic.py` 上傳至該資料夾。
3.  確保您有 `FinMind` 的 API Token (若無可使用免費版，但建議申請)。

### 2. 執行程式
1.  開啟 `Main.ipynb` (或新建 Colab Notebook)。
2.  掛載 Google Drive：
    ```python
    from google.colab import drive
    drive.mount('/content/drive')
    ```
3.  執行主程式碼，系統會自動：
    * 安裝必要套件 (`gspread`, `twstock`, `yfinance`...)。
    * 載入 `Stock_V116` 資料夾中的模組。
    * 爬取最新數據並寫入您的 Google Sheet。

## ⚙️ 核心邏輯說明

### 處置預測 (Prediction Logic)
系統會回朔過去 30 個交易日，依據證交所規定之「連續 3 日」、「連續 5 日」、「10 日內 6 次」、「30 日內 12 次」等條件進行模擬。
* **0 天**：代表今日已達標（次一營業日進處置）或目前正在處置中。
* **1 天**：代表再觸發 1 次即進入處置。

### 歸零機制 (Jail Reset)
為了符合法規，當偵測到股票「處置結束」時，系統會自動切斷該日期之前的累積次數（案底歸零），防止出獄後因舊紀錄而導致誤判。

### 關鍵字對照 (Keyword Mapping)
位於 `config.py` 中，用於解決官方公告格式不統一的問題（例如將「起迄兩個營業日」自動轉譯為「第11款」），確保計次正確。

## ⚠️ 注意事項
* **Python 版本**：本專案相容 Python 3.10+ (Colab 預設環境)。
* **API 限制**：FinMind 免費版有呼叫次數限制，若執行大量股票掃描建議使用付費 Token。
* **資料延遲**：證交所公告通常於每日 17:00 後更新，建議於 19:00 後執行程式以確保數據完整。

---
*Last Updated: 2025-12-24*
